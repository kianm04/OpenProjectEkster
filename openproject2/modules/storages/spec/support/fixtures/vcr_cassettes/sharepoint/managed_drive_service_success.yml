---
http_interactions:
- request:
    method: post
    uri: https://login.microsoftonline.com/e36f1dbc-fdae-427e-b61b-0d96ddfb81a4/oauth2/v2.0/token
    body:
      encoding: ASCII-8BIT
      string: grant_type=client_credentials&scope=https%3A%2F%2Fgraph.microsoft.com%2F.default+offline_access&client_id=404e0567-19a1-4a64-b2d1-d3b0c99f2ed9&client_secret=QRB8Q%7Ei.1rID_.MC9FTfRGq-FTE5SgWYsoeLacWf
    headers:
      User-Agent:
      - httpx.rb/1.6.3
      Accept:
      - "*/*"
      Accept-Encoding:
      - gzip, deflate
      Content-Type:
      - application/x-www-form-urlencoded
      Content-Length:
      - '199'
  response:
    status:
      code: 200
      message: OK
    headers:
      Cache-Control:
      - no-store, no-cache
      Pragma:
      - no-cache
      Content-Type:
      - application/json; charset=utf-8
      Expires:
      - "-1"
      Strict-Transport-Security:
      - max-age=31536000; includeSubDomains
      X-Content-Type-Options:
      - nosniff
      P3p:
      - CP="DSP CUR OTPi IND OTRi ONL FIN"
      X-Ms-Request-Id:
      - 40f527e2-7881-493d-b0fe-4164c90f6b00
      X-Ms-Ests-Server:
      - 2.1.22549.2 - FRC ProdSlices
      X-Ms-Srs:
      - 1.P
      Content-Security-Policy-Report-Only:
      - object-src 'none'; base-uri 'self'; script-src 'self' 'nonce-nF5WoLivXZ9hQV5hBqgDXA'
        'unsafe-inline' 'unsafe-eval' https://*.msauth.net https://*.msftauth.net
        https://*.msftauthimages.net https://*.msauthimages.net https://*.msidentity.com
        https://*.microsoftonline-p.com https://*.microsoftazuread-sso.com https://*.azureedge.net
        https://*.outlook.com https://*.office.com https://*.office365.com https://*.microsoft.com
        https://*.bing.com 'report-sample'; report-uri https://csp.microsoft.com/report/ESTS-UX-All
      X-Xss-Protection:
      - '0'
      Set-Cookie:
      - fpc=AqN-9lUw7BxLrUcbs52JEtVZ-dCOAQAAAMYdseAOAAAA; expires=Sat, 20-Dec-2025
        14:33:42 GMT; path=/; secure; HttpOnly; SameSite=None, x-ms-gateway-slice=estsfd;
        path=/; secure; samesite=none; httponly, stsservicecookie=estsfd; path=/;
        secure; samesite=none; httponly
      Date:
      - Thu, 20 Nov 2025 14:33:41 GMT
      Content-Length:
      - '2033'
    body:
      encoding: UTF-8
      string: '{"token_type":"Bearer","expires_in":3599,"ext_expires_in":3599,"access_token":"<ACCESS_TOKEN>"}'
  recorded_at: Thu, 20 Nov 2025 14:33:42 GMT
- request:
    method: post
    uri: https://graph.microsoft.com/v1.0/sites/ymt6d.sharepoint.com:/sites/OPTest:/lists
    body:
      encoding: UTF-8
      string: '{"displayName":"OpenProject Test","description":"OpenProject access-managed
        document library","list":{"template":"documentLibrary"}}'
    headers:
      User-Agent:
      - httpx.rb/1.6.3
      Accept:
      - "*/*"
      Accept-Encoding:
      - gzip, deflate
      Content-Type:
      - application/json; charset=utf-8
      Content-Length:
      - '132'
      Authorization:
      - Bearer <BEARER TOKEN>
  response:
    status:
      code: 201
      message: Created
    headers:
      Cache-Control:
      - no-store, no-cache
      Content-Type:
      - application/json;odata.metadata=minimal;odata.streaming=true;IEEE754Compatible=false;charset=utf-8
      Content-Encoding:
      - gzip
      Etag:
      - f5459cae-fa8f-4042-a413-8a70764b3fd6,0
      Location:
      - https://ymt6d.sharepoint.com/_api/v2.0/sites('ymt6d.sharepoint.com')/lists('f5459cae-fa8f-4042-a413-8a70764b3fd6')
      Vary:
      - Accept-Encoding
      Strict-Transport-Security:
      - max-age=31536000
      Request-Id:
      - c999f6ba-1454-4a73-ad34-68525b2d9a5c
      Client-Request-Id:
      - c999f6ba-1454-4a73-ad34-68525b2d9a5c
      X-Ms-Ags-Diagnostic:
      - '{"ServerInfo":{"DataCenter":"Germany West Central","Slice":"E","Ring":"4","ScaleUnit":"000","RoleInstance":"FR1PEPF00000F49"}}'
      Splogid:
      - c53ddba1-9006-0000-8a2e-01d046de448f
      Odata-Version:
      - '4.0'
      Date:
      - Thu, 20 Nov 2025 14:33:43 GMT
    body:
      encoding: UTF-8
      string: '{"@odata.context":"https://graph.microsoft.com/v1.0/$metadata#Collection(microsoft.graph.list)/$entity","@odata.etag":"f5459cae-fa8f-4042-a413-8a70764b3fd6,0","eTag":"f5459cae-fa8f-4042-a413-8a70764b3fd6,0","lastModifiedDateTime":"2025-11-20T14:33:43Z","createdDateTime":"2025-11-20T14:33:43Z","description":"OpenProject
        access-managed document library","id":"f5459cae-fa8f-4042-a413-8a70764b3fd6","name":"OpenProject
        Test","webUrl":"https://ymt6d.sharepoint.com/sites/OPTest/OpenProject%20Test","displayName":"OpenProject
        Test","parentReference":{"siteId":"ymt6d.sharepoint.com,1099e315-d0c7-47c7-8640-aa9504b70fff,6af246f0-e3be-45ef-b91a-8eca4dcc5d8f"},"list":{"contentTypesEnabled":false,"hidden":false,"template":"documentLibrary"}}'
  recorded_at: Thu, 20 Nov 2025 14:33:43 GMT
- request:
    method: get
    uri: https://graph.microsoft.com/v1.0/sites/ymt6d.sharepoint.com:/sites/OPTest:/lists/OpenProject%20Test?$expand=drive&$select=id,name,drive
    body:
      encoding: US-ASCII
      string: ''
    headers:
      User-Agent:
      - httpx.rb/1.6.3
      Accept:
      - "*/*"
      Accept-Encoding:
      - gzip, deflate
      Authorization:
      - Bearer <BEARER TOKEN>
  response:
    status:
      code: 200
      message: OK
    headers:
      Cache-Control:
      - no-cache
      Content-Type:
      - application/json;odata.metadata=minimal;odata.streaming=true;IEEE754Compatible=false;charset=utf-8
      Content-Encoding:
      - gzip
      Etag:
      - '"f5459cae-fa8f-4042-a413-8a70764b3fd6,0"'
      Vary:
      - Accept-Encoding
      Strict-Transport-Security:
      - max-age=31536000
      Request-Id:
      - c0a07ca1-ee18-43c4-802a-c5fa3ef87970
      Client-Request-Id:
      - c0a07ca1-ee18-43c4-802a-c5fa3ef87970
      X-Ms-Ags-Diagnostic:
      - '{"ServerInfo":{"DataCenter":"Germany West Central","Slice":"E","Ring":"4","ScaleUnit":"000","RoleInstance":"FR1PEPF00000F49"}}'
      Splogid:
      - c53ddba1-c030-0000-9865-06dcc698b1ea
      Odata-Version:
      - '4.0'
      Date:
      - Thu, 20 Nov 2025 14:33:43 GMT
    body:
      encoding: UTF-8
      string: '{"@odata.context":"https://graph.microsoft.com/v1.0/$metadata#Collection(microsoft.graph.list)(id,name,drive,drive())/$entity","@odata.etag":"\"f5459cae-fa8f-4042-a413-8a70764b3fd6,0\"","id":"f5459cae-fa8f-4042-a413-8a70764b3fd6","name":"OpenProject
        Test","drive@odata.context":"https://graph.microsoft.com/v1.0/$metadata#Collection(microsoft.graph.list)(''f5459cae-fa8f-4042-a413-8a70764b3fd6'')/drive/$entity","drive":{"createdDateTime":"2025-11-20T14:33:43Z","description":"OpenProject
        access-managed document library","id":"b!FeOZEMfQx0eGQKqVBLcP__BG8mq-4-9FuRqOyk3MXY-unEX1j_pCQKQTinB2Sz_W","lastModifiedDateTime":"2025-11-20T14:33:43Z","name":"OpenProject
        Test","webUrl":"https://ymt6d.sharepoint.com/sites/OPTest/OpenProject%20Test","driveType":"documentLibrary","createdBy":{"user":{"displayName":"SharePoint
        App"}},"owner":{"group":{"email":"OPTest@ymt6d.onmicrosoft.com","id":"5dfb4269-d3e3-4c70-83f5-c4937ff6dcdb","displayName":"OP
        Test Owners"}},"quota":{"deleted":6723542,"remaining":27487613129698,"state":"normal","total":27487790694400,"used":170841160}}}'
  recorded_at: Thu, 20 Nov 2025 14:33:43 GMT
- request:
    method: get
    uri: https://graph.microsoft.com/v1.0/drives/b!FeOZEMfQx0eGQKqVBLcP__BG8mq-4-9FuRqOyk3MXY-unEX1j_pCQKQTinB2Sz_W/root/permissions
    body:
      encoding: US-ASCII
      string: ''
    headers:
      User-Agent:
      - httpx.rb/1.6.3
      Accept:
      - "*/*"
      Accept-Encoding:
      - gzip, deflate
      Authorization:
      - Bearer <BEARER TOKEN>
  response:
    status:
      code: 200
      message: OK
    headers:
      Cache-Control:
      - no-store, no-cache
      Content-Type:
      - application/json;odata.metadata=minimal;odata.streaming=true;IEEE754Compatible=false;charset=utf-8
      Content-Encoding:
      - gzip
      Vary:
      - Accept-Encoding
      Strict-Transport-Security:
      - max-age=31536000
      Request-Id:
      - 26fd2008-029d-4761-b162-cb12d1c527ea
      Client-Request-Id:
      - 26fd2008-029d-4761-b162-cb12d1c527ea
      X-Ms-Ags-Diagnostic:
      - '{"ServerInfo":{"DataCenter":"Germany West Central","Slice":"E","Ring":"4","ScaleUnit":"000","RoleInstance":"FR1PEPF00000F49"}}'
      Link:
      - <https://developer.microsoft-tst.com/en-us/graph/changes?$filterby=v1.0,Removal&from=2021-09-01&to=2021-10-01>;rel="deprecation";type="text/html",
        <https://developer.microsoft-tst.com/en-us/graph/changes?$filterby=v1.0,Removal&from=2021-09-01&to=2021-10-01>;rel="deprecation";type="text/html"
      Deprecation:
      - Fri, 03 Sep 2021 23:59:59 GMT
      Sunset:
      - Sun, 01 Oct 2023 23:59:59 GMT
      Splogid:
      - c53ddba1-3040-0000-8a2e-0106f54ce09b
      Odata-Version:
      - '4.0'
      Date:
      - Thu, 20 Nov 2025 14:33:43 GMT
    body:
      encoding: UTF-8
      string: '{"@odata.context":"https://graph.microsoft.com/v1.0/$metadata#drives(''b%21FeOZEMfQx0eGQKqVBLcP__BG8mq-4-9FuRqOyk3MXY-unEX1j_pCQKQTinB2Sz_W'')/root/permissions","value":[{"id":"T1AgVGVzdCBPd25lcnM","roles":["owner"],"shareId":"T1AgVGVzdCBPd25lcnM","grantedToV2":{"siteGroup":{"displayName":"OP
        Test Owners","id":"3","loginName":"OP Test Owners"}},"grantedTo":{"user":{"displayName":"OP
        Test Owners"}},"inheritedFrom":{}},{"id":"T1AgVGVzdCBWaXNpdG9ycw","roles":["read"],"shareId":"T1AgVGVzdCBWaXNpdG9ycw","grantedToV2":{"siteGroup":{"displayName":"OP
        Test Visitors","id":"4","loginName":"OP Test Visitors"}},"grantedTo":{"user":{"displayName":"OP
        Test Visitors"}},"inheritedFrom":{}},{"id":"T1AgVGVzdCBNZW1iZXJz","roles":["write"],"shareId":"T1AgVGVzdCBNZW1iZXJz","grantedToV2":{"siteGroup":{"displayName":"OP
        Test Members","id":"5","loginName":"OP Test Members"}},"grantedTo":{"user":{"displayName":"OP
        Test Members"}},"inheritedFrom":{}},{"id":"Yzowby5jfGZlZGVyYXRlZGRpcmVjdG9yeWNsYWltcHJvdmlkZXJ8NWRmYjQyNjktZDNlMy00YzcwLTgzZjUtYzQ5MzdmZjZkY2RiX28","roles":["owner"],"shareId":"Yzowby5jfGZlZGVyYXRlZGRpcmVjdG9yeWNsYWltcHJvdmlkZXJ8NWRmYjQyNjktZDNlMy00YzcwLTgzZjUtYzQ5MzdmZjZkY2RiX28","grantedToV2":{"group":{"@odata.type":"#microsoft.graph.sharePointIdentity","displayName":"OP
        Test Owners","email":"OPTest@ymt6d.onmicrosoft.com","id":"5dfb4269-d3e3-4c70-83f5-c4937ff6dcdb"},"siteUser":{"displayName":"OP
        Test Owners","email":"OPTest@ymt6d.onmicrosoft.com","id":"6","loginName":"c:0o.c|federateddirectoryclaimprovider|5dfb4269-d3e3-4c70-83f5-c4937ff6dcdb_o"}},"grantedTo":{"user":{"displayName":"OP
        Test Owners","email":"OPTest@ymt6d.onmicrosoft.com","id":"5dfb4269-d3e3-4c70-83f5-c4937ff6dcdb"}},"inheritedFrom":{}}]}'
  recorded_at: Thu, 20 Nov 2025 14:33:43 GMT
- request:
    method: delete
    uri: https://graph.microsoft.com/v1.0/drives/b!FeOZEMfQx0eGQKqVBLcP__BG8mq-4-9FuRqOyk3MXY-unEX1j_pCQKQTinB2Sz_W/root/permissions/T1AgVGVzdCBPd25lcnM
    body:
      encoding: US-ASCII
      string: ''
    headers:
      User-Agent:
      - httpx.rb/1.6.3
      Accept:
      - "*/*"
      Accept-Encoding:
      - gzip, deflate
      Authorization:
      - Bearer <BEARER TOKEN>
  response:
    status:
      code: 204
      message: No Content
    headers:
      Cache-Control:
      - no-store, no-cache
      Strict-Transport-Security:
      - max-age=31536000
      Request-Id:
      - 3797a677-6e36-4cc4-88c6-39b71249f670
      Client-Request-Id:
      - 3797a677-6e36-4cc4-88c6-39b71249f670
      X-Ms-Ags-Diagnostic:
      - '{"ServerInfo":{"DataCenter":"Germany West Central","Slice":"E","Ring":"4","ScaleUnit":"000","RoleInstance":"FR1PEPF00000F49"}}'
      Link:
      - <https://developer.microsoft-tst.com/en-us/graph/changes?$filterby=v1.0,Removal&from=2021-09-01&to=2021-10-01>;rel="deprecation";type="text/html",
        <https://developer.microsoft-tst.com/en-us/graph/changes?$filterby=v1.0,Removal&from=2021-09-01&to=2021-10-01>;rel="deprecation";type="text/html"
      Deprecation:
      - Fri, 03 Sep 2021 23:59:59 GMT
      Sunset:
      - Sun, 01 Oct 2023 23:59:59 GMT
      Splogid:
      - c53ddba1-204a-0000-9865-0db41928fa26
      Date:
      - Thu, 20 Nov 2025 14:33:43 GMT
    body:
      encoding: UTF-8
      string: ''
  recorded_at: Thu, 20 Nov 2025 14:33:44 GMT
- request:
    method: delete
    uri: https://graph.microsoft.com/v1.0/drives/b!FeOZEMfQx0eGQKqVBLcP__BG8mq-4-9FuRqOyk3MXY-unEX1j_pCQKQTinB2Sz_W/root/permissions/T1AgVGVzdCBWaXNpdG9ycw
    body:
      encoding: US-ASCII
      string: ''
    headers:
      User-Agent:
      - httpx.rb/1.6.3
      Accept:
      - "*/*"
      Accept-Encoding:
      - gzip, deflate
      Authorization:
      - Bearer <BEARER TOKEN>
  response:
    status:
      code: 204
      message: No Content
    headers:
      Cache-Control:
      - no-store, no-cache
      Strict-Transport-Security:
      - max-age=31536000
      Request-Id:
      - a22b34b9-aa9d-490d-ad7c-a9ea18ec997d
      Client-Request-Id:
      - a22b34b9-aa9d-490d-ad7c-a9ea18ec997d
      X-Ms-Ags-Diagnostic:
      - '{"ServerInfo":{"DataCenter":"Germany West Central","Slice":"E","Ring":"4","ScaleUnit":"000","RoleInstance":"FR1PEPF00000F49"}}'
      Link:
      - <https://developer.microsoft-tst.com/en-us/graph/changes?$filterby=v1.0,Removal&from=2021-09-01&to=2021-10-01>;rel="deprecation";type="text/html",
        <https://developer.microsoft-tst.com/en-us/graph/changes?$filterby=v1.0,Removal&from=2021-09-01&to=2021-10-01>;rel="deprecation";type="text/html"
      Deprecation:
      - Fri, 03 Sep 2021 23:59:59 GMT
      Sunset:
      - Sun, 01 Oct 2023 23:59:59 GMT
      Splogid:
      - c53ddba1-9059-0000-8a2e-0631fbcc0d0c
      Date:
      - Thu, 20 Nov 2025 14:33:43 GMT
    body:
      encoding: UTF-8
      string: ''
  recorded_at: Thu, 20 Nov 2025 14:33:44 GMT
- request:
    method: delete
    uri: https://graph.microsoft.com/v1.0/drives/b!FeOZEMfQx0eGQKqVBLcP__BG8mq-4-9FuRqOyk3MXY-unEX1j_pCQKQTinB2Sz_W/root/permissions/T1AgVGVzdCBNZW1iZXJz
    body:
      encoding: US-ASCII
      string: ''
    headers:
      User-Agent:
      - httpx.rb/1.6.3
      Accept:
      - "*/*"
      Accept-Encoding:
      - gzip, deflate
      Authorization:
      - Bearer <BEARER TOKEN>
  response:
    status:
      code: 204
      message: No Content
    headers:
      Cache-Control:
      - no-store, no-cache
      Strict-Transport-Security:
      - max-age=31536000
      Request-Id:
      - 43322f54-5343-4226-b4b5-e3b557a65bab
      Client-Request-Id:
      - 43322f54-5343-4226-b4b5-e3b557a65bab
      X-Ms-Ags-Diagnostic:
      - '{"ServerInfo":{"DataCenter":"Germany West Central","Slice":"E","Ring":"4","ScaleUnit":"000","RoleInstance":"FR1PEPF00000F49"}}'
      Link:
      - <https://developer.microsoft-tst.com/en-us/graph/changes?$filterby=v1.0,Removal&from=2021-09-01&to=2021-10-01>;rel="deprecation";type="text/html",
        <https://developer.microsoft-tst.com/en-us/graph/changes?$filterby=v1.0,Removal&from=2021-09-01&to=2021-10-01>;rel="deprecation";type="text/html"
      Deprecation:
      - Fri, 03 Sep 2021 23:59:59 GMT
      Sunset:
      - Sun, 01 Oct 2023 23:59:59 GMT
      Splogid:
      - c53ddba1-506c-0000-9865-08100c58b6b7
      Date:
      - Thu, 20 Nov 2025 14:33:44 GMT
    body:
      encoding: UTF-8
      string: ''
  recorded_at: Thu, 20 Nov 2025 14:33:44 GMT
- request:
    method: delete
    uri: https://graph.microsoft.com/v1.0/drives/b!FeOZEMfQx0eGQKqVBLcP__BG8mq-4-9FuRqOyk3MXY-unEX1j_pCQKQTinB2Sz_W/root/permissions/Yzowby5jfGZlZGVyYXRlZGRpcmVjdG9yeWNsYWltcHJvdmlkZXJ8NWRmYjQyNjktZDNlMy00YzcwLTgzZjUtYzQ5MzdmZjZkY2RiX28
    body:
      encoding: US-ASCII
      string: ''
    headers:
      User-Agent:
      - httpx.rb/1.6.3
      Accept:
      - "*/*"
      Accept-Encoding:
      - gzip, deflate
      Authorization:
      - Bearer <BEARER TOKEN>
  response:
    status:
      code: 204
      message: No Content
    headers:
      Cache-Control:
      - no-store, no-cache
      Strict-Transport-Security:
      - max-age=31536000
      Request-Id:
      - 3f500d2f-4ca4-4ce7-9ae5-3d410c3036c3
      Client-Request-Id:
      - 3f500d2f-4ca4-4ce7-9ae5-3d410c3036c3
      X-Ms-Ags-Diagnostic:
      - '{"ServerInfo":{"DataCenter":"Germany West Central","Slice":"E","Ring":"4","ScaleUnit":"000","RoleInstance":"FR1PEPF00000F49"}}'
      Link:
      - <https://developer.microsoft-tst.com/en-us/graph/changes?$filterby=v1.0,Removal&from=2021-09-01&to=2021-10-01>;rel="deprecation";type="text/html",
        <https://developer.microsoft-tst.com/en-us/graph/changes?$filterby=v1.0,Removal&from=2021-09-01&to=2021-10-01>;rel="deprecation";type="text/html"
      Deprecation:
      - Fri, 03 Sep 2021 23:59:59 GMT
      Sunset:
      - Sun, 01 Oct 2023 23:59:59 GMT
      Splogid:
      - c53ddba1-a07f-0000-8a2e-0302e1f75079
      Date:
      - Thu, 20 Nov 2025 14:33:44 GMT
    body:
      encoding: UTF-8
      string: ''
  recorded_at: Thu, 20 Nov 2025 14:33:44 GMT
- request:
    method: delete
    uri: https://graph.microsoft.com/v1.0/sites/ymt6d.sharepoint.com:/sites/OPTest:/lists/OpenProject%20Test
    body:
      encoding: US-ASCII
      string: ''
    headers:
      User-Agent:
      - httpx.rb/1.6.3
      Accept:
      - "*/*"
      Accept-Encoding:
      - gzip, deflate
      Authorization:
      - Bearer <BEARER TOKEN>
  response:
    status:
      code: 204
      message: No Content
    headers:
      Cache-Control:
      - no-store, no-cache
      Strict-Transport-Security:
      - max-age=31536000
      Request-Id:
      - d5ba2c6c-2f02-4626-9515-0292c2da4894
      Client-Request-Id:
      - d5ba2c6c-2f02-4626-9515-0292c2da4894
      X-Ms-Ags-Diagnostic:
      - '{"ServerInfo":{"DataCenter":"Germany West Central","Slice":"E","Ring":"4","ScaleUnit":"000","RoleInstance":"FR1PEPF000007A3"}}'
      Splogid:
      - c53ddba1-a091-0000-97a9-a1a6e18a8da7
      Date:
      - Thu, 20 Nov 2025 14:33:44 GMT
    body:
      encoding: UTF-8
      string: ''
  recorded_at: Thu, 20 Nov 2025 14:33:45 GMT
recorded_with: VCR 6.3.1
